<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shempions League</title>
  <link rel="stylesheet" href="../assets/style.css">
  <style>
    /* Ajustes m√≠nimos espec√≠ficos del runner */
    #distanceLabel { position:absolute; top:12px; right:20px; color:#333; font-weight:bold; }
  </style>
  <script src="../assets/gameStorage.js"></script>
  <script src="../assets/sidePanel.js"></script>
</head>
<body>
  <div id="container">
    <div id="gameWrapper">
      <span id="distanceLabel"></span>
      <canvas id="game"></canvas>
    </div>
  </div>

  <div id="winModal" class="hidden">
    <div class="modal-content">
      <h1>¬°GOL EN EL 93! üèÜ‚öΩ</h1>
      <h3>El bixo lo consigui√≥: La Champiooooooooooooons.</h3>
      <div class="modal-actions">
        <button class="modal-btn" id="winBackBtn">Volver al men√∫</button>
        <button class="modal-btn" id="winRestartBtn">Jugar de nuevo</button>
      </div>
    </div>
  </div>

  <div id="gameOverModal" class="hidden">
    <div class="modal-content">
      <h1>¬°Qu√© inyustisia...! üòµ</h1>
      <h3>Int√©ntalo de nuevo para marcar en el 93.</h3>
      <div class="modal-actions">
        <button class="modal-btn" id="overBackBtn">Volver al men√∫</button>
        <button class="modal-btn" id="overRestartBtn">Reintentar</button>
      </div>
    </div>
  </div>

  <div id="startModal">
    <div class="modal-content">
      <h1>‚öΩ ¬°SIIIU! ‚öΩ</h1>
      <h2>El bixo necesita tu ayuda para ganar la Champions y llevar el trofeo a tu cumplea√±os. Ay√∫dale a sortear a Mepsi y los fueras de juego para marcar en el 93.</h2>
      <div class="modal-actions">
        <button class="modal-btn" id="startBtn">Comenzar</button>
      </div>
    </div>
  </div>

  <script src="juego2.js"></script>
  <script>
    // Panel lateral para Juego 2
    let gameStats = { score: 0, level: 1, status: 'üîÑ En Progreso' };
    let gameOptions = { cr7: false };

    function initSidePanel() {
      if (!window.SidePanel) return;
      window.SidePanel.createSidePanel({
        gameName: 'Shempions League',
        gameId: 'juego2',
        stats: gameStats,
        options: gameOptions,
        optionsTemplate: `
          <div class=\"panel-section\">
            <h4>‚öôÔ∏è Opciones</h4>
            <div class=\"option-item\">
              <span class=\"option-label\">Modo CR7</span>
              <div class=\"toggle ${gameOptions.cr7 ? 'active' : ''}\" id=\"cr7Toggle\"></div>
            </div>
          </div>
          <button class=\"btn secondary\" id=\"fullscreenBtn\">‚õ∂ Pantalla completa</button>
        `,
        initOptions: (panel, onOptionChange) => {
          const cr7 = panel.querySelector('#cr7Toggle');
          if (cr7) {
            cr7.addEventListener('click', function(){
              this.classList.toggle('active');
              const active = this.classList.contains('active');
              onOptionChange({ cr7: active });
            });
          }
        },
        onBack: () => window.location.href = '../index.html',
        onRestart: () => { if (typeof resetGame === 'function') resetGame(); },
        onOptionChange: (opts) => {
          gameOptions = { ...gameOptions, ...opts };
          if (window.GameStorage) window.GameStorage.updateGameOptions(gameOptions);
          if (opts.cr7 !== undefined && typeof setCR7Mode === 'function') setCR7Mode(opts.cr7);
        }
      });
    }
    document.addEventListener('DOMContentLoaded', initSidePanel);

    // Hook de actualizaci√≥n de stats
    function setupStatsHook() {
      if (typeof getCurrentScore === 'function') {
        setInterval(() => {
          try {
            const s = getCurrentScore();
            gameStats.score = Math.floor(s);
            gameStats.level = Math.max(1, Math.floor(s / 10));
            gameStats.status = WIN_STATE ? '‚úÖ En el 93' : 'üîÑ En Progreso';
            if (window.SidePanel) window.SidePanel.updateSidePanelStats(gameStats);
          } catch {}
        }, 500);
      }
    }
    setTimeout(setupStatsHook, 500);
  </script>
</body>
</html>
