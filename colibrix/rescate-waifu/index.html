<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rescate Waifu ‚Äî Whac-a-mole</title>
  <link rel="stylesheet" href="../../assets/style.css" />
  <style>
    /* Cursor personalizado solo dentro del cuadrado de juego */
    #gameArea, #gameArea * {
      cursor: url('https://i.postimg.cc/DfLXmRdY/gun2.png') 0 0, auto;
    }
    /* Zona de juego dentro del modal com√∫n */
    #gameArea { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; padding: 20px; }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(3, 1fr); gap: 14px; width: min(88%, 560px); aspect-ratio: 1 / 1; }
    .cell { position: relative; background: #f6fff6; border: 2px solid #6ab04c; border-radius: 12px; box-shadow: inset 0 0 8px rgba(0,0,0,0.08); overflow: hidden; }
    .target { position: absolute; left: 50%; top: 50%; width: 80%; transform: translate(-50%, -50%) scale(0.9); opacity: 0; pointer-events: auto; animation: fadePop 1000ms ease forwards; }
    .target.red, .target.green { box-shadow: none; }
    .target img { width: 100%; height: auto; object-fit: contain; display: block; }
    .target:active { transform: translate(-50%, -50%) scale(0.55); }
    @keyframes fadePop { 0% { opacity: 0; transform: translate(-50%, -50%) scale(0.85);} 10% { opacity: 1; transform: translate(-50%, -50%) scale(1);} 90% { opacity: 1; transform: translate(-50%, -50%) scale(1);} 100% { opacity: 0; transform: translate(-50%, -50%) scale(0.85);} }

    /* Etiqueta de estado arriba a la izquierda del wrapper */
    .status-chip { position: absolute; top: 8px; left: 8px; background: rgba(0,0,0,0.6); color: #fff; padding: 8px 12px; border-radius: 999px; font-size: 16px; letter-spacing: .2px; z-index: 5; }
  </style>
  <script src="../../assets/gameStorage.js"></script>
  <script src="../../assets/sidePanel.js"></script>
</head>
<body>
  <div id="container">
    <div id="gameWrapper">
      <div class="status-chip" id="statusChip">Muertos: 0</div>
      <div id="gameArea">
        <div class="grid" id="grid">
          <div class="cell" data-idx="0"></div>
          <div class="cell" data-idx="1"></div>
          <div class="cell" data-idx="2"></div>
          <div class="cell" data-idx="3"></div>
          <div class="cell" data-idx="4"></div>
          <div class="cell" data-idx="5"></div>
          <div class="cell" data-idx="6"></div>
          <div class="cell" data-idx="7"></div>
          <div class="cell" data-idx="8"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modales estilo com√∫n -->
  <div id="winModal" class="hidden">
    <div class="modal-content">
      <h1>¬°Oni-chan UwU! üíñüèÜ</h1>
      <h3>Me has salvado... eres mi h√©roe. Hazme lo que quieras, nyaa~ ‚ù§Ô∏è</h3>
      <div class="modal-actions">
        <button class="modal-btn" id="winBackBtn">Volver al men√∫</button>
        <button class="modal-btn" id="winRestartBtn">Jugar de nuevo</button>
      </div>
    </div>
  </div>

  <div id="gameOverModal" class="hidden">
    <div class="modal-content">
      <h1>¬°Dep waifu, acabas de volarle los sesos! üòµ</h1>
      <h3>Intenta no asesinar ninguna waifu</h3>
      <div class="modal-actions">
        <button class="modal-btn" id="overBackBtn">Volver al men√∫</button>
        <button class="modal-btn" id="overRestartBtn">Reintentar</button>
      </div>
    </div>
  </div>

  <div id="startModal">
    <div class="modal-content">
      <h1>UwU kawaii, resc√°tanos Oni-chaaaan</h1>
      <h2>
        Dispara a los secuestradores para evitar que secuestren a las waifus ¬°NO LAS DISPARES!
        Consigue rescatar a 10 waifus para ganar. Si disparas a una waifu perder√°s.
      </h2>
      <div class="modal-actions">
        <button class="modal-btn" id="startBtn">Empezar</button>
      </div>
    </div>
  </div>

  <!-- Sonido de disparo -->
  <audio id="gunSound" src="../../sounds/gun.mp3" preload="auto"></audio>

  <!-- Audio de fondo de cumplea√±os -->
  <audio id="bgBirthday" src="../../sounds/birthday.mp3" loop></audio>
  <script>
    (function(){
      const a = document.getElementById('bgBirthday');
      if (!a) return;
      a.volume = 0.6;
      a.play().catch(()=>{});
    })();
  </script>

  <script src="rescate-waifu.js"></script>
</body>
</html>
